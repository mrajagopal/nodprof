// Generated by CoffeeScript 1.6.3
var addChart, profileView, renderer, _;

_ = require("underscore");

renderer = require("./renderProfileFlameGraph");

profileView = exports;

profileView.show = function(fileName, $scope, $http) {
  var content$, el$, httpResponse, id, idSel, trash$;
  id = fileName.replace(/\./g, "-");
  id = "d-" + id;
  idSel = "#" + id;
  content$ = $("#content");
  el$ = $(idSel, content$);
  if (el$.length) {
    $('html,body').animate({
      scrollTop: el$.offset().top
    });
    return;
  }
  el$ = $("<div id=\"" + id + "\" class=\"chart prof\">\n    <i class=\"icon-trash pull-right\"></i>\n    <h2>profile " + fileName + "</h2>\n</div>");
  content$.prepend(el$);
  trash$ = $(".icon-trash", el$);
  trash$.click(function() {
    return el$.remove();
  });
  httpResponse = $http.get("api/files/" + fileName);
  httpResponse.success(function(data, status, headers, config) {
    addChart(idSel, data);
    return $scope.resizeChart($(idSel));
  });
  httpResponse.error(function(data, status, headers, config) {
    return $scope.error("error getting file " + fileName + ": " + status);
  });
};

addChart = function(idSel, data) {
  return renderer.render(idSel, data);
};
